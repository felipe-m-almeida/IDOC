<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MATQM - Dados de Qualidade</title>
    <link rel="stylesheet" href="estilos.css">
    <script>const IDOC_TREE = [{"segment": "E1BP1001004_QMAT", "max": 999999999, "children": []}]; const SEGMENT_DEFINITIONS = {"E1BP1001004_QMAT": {"desc": "Dds.controle QM material (QMAT) ALE distribui\u00e7\u00e3o com BAPI", "fields": [{"name": "FUNCTION", "desc": "Fun\u00e7\u00e3o", "type": "CHAR", "len": "3"}, {"name": "INSPTYPE", "desc": "Tipo de controle", "type": "CHAR", "len": "8"}, {"name": "MATERIAL", "desc": "N\u00ba do material", "type": "CHAR", "len": "18"}, {"name": "PLANT", "desc": "Centro", "type": "CHAR", "len": "4"}, {"name": "IND_INSP_WITH_TSK_LIST", "desc": "Controle com lista de tarefas", "type": "CHAR", "len": "1"}, {"name": "IND_SPEC_MATSPEC", "desc": "Controle com especifica\u00e7\u00e3o de material", "type": "CHAR", "len": "1"}, {"name": "IND_SPEC_CONFIG", "desc": "Especifica\u00e7\u00f5es de controle da configura\u00e7\u00e3o", "type": "CHAR", "len": "1"}, {"name": "IND_SPEC_BATCH", "desc": "Especifica\u00e7\u00f5es de controle da determina\u00e7\u00e3o de lotes", "type": "CHAR", "len": "1"}, {"name": "IND_AUTO_ASSIGN", "desc": "Atribui\u00e7\u00e3o autom\u00e1tica de especifica\u00e7\u00f5es", "type": "CHAR", "len": "1"}, {"name": "IND_INSP_BY_CHARAC", "desc": "Efetuar controle por caracter\u00edsticas", "type": "CHAR", "len": "1"}, {"name": "IND_POST_TO_INSP_STOCK", "desc": "Registro em estoque em controle de qualidade", "type": "CHAR", "len": "1"}, {"name": "IND_AUTOMATIC_UD", "desc": "Decis\u00e3o de utiliza\u00e7\u00e3o autom\u00e1tica prevista", "type": "CHAR", "len": "1"}, {"name": "SAMPLING_PROCEDURE", "desc": "Processo de amostra", "type": "CHAR", "len": "8"}, {"name": "DYN_MODIF_RULE", "desc": "Regra de controle din\u00e2mico", "type": "CHAR", "len": "3"}, {"name": "INSP_PERCENTAGE", "desc": "Porcentagem de controle", "type": "DEC", "len": "3"}, {"name": "IND_100_PERCENT_INSPECTION", "desc": "Controle a 100%", "type": "CHAR", "len": "1"}, {"name": "IND_SKIPS_ALLOWED", "desc": "Skips permitidos", "type": "CHAR", "len": "1"}, {"name": "IND_MANUAL_SAMPLE", "desc": "Indicar amostra manualmente", "type": "CHAR", "len": "1"}, {"name": "IND_MANUAL_SAMPLE_CALC", "desc": "Acionar c\u00e1lculo de amostra manualmente", "type": "CHAR", "len": "1"}, {"name": "IND_SINGLE_UNITS_POSSIBLE", "desc": "Administra\u00e7\u00e3o de n\u00bas de s\u00e9rie", "type": "CHAR", "len": "1"}, {"name": "AVE_INSP_DURATION", "desc": "Dura\u00e7\u00e3o m\u00e9dia do controle", "type": "DEC", "len": "3"}, {"name": "CONTR_INSP_LOT_CREATE", "desc": "Controle da cria\u00e7\u00e3o de lote de controle (agrupamento lotes)", "type": "CHAR", "len": "1"}, {"name": "QUAL_SCORE_PROCEDURE", "desc": "Processo para c\u00e1lculo do \u00edndice de qualidade", "type": "CHAR", "len": "2"}, {"name": "ALLOWED_SCRAP_SHARE", "desc": "Quota de refugo permitida (em %) no lote de controle", "type": "DEC", "len": "6"}, {"name": "IND_SPECIAL_QM_ORDER", "desc": "Entrar custos de controle na ordem QM individual", "type": "CHAR", "len": "1"}, {"name": "QM_ORDERID", "desc": "N\u00ba ordem para a entrada de custos de controle", "type": "CHAR", "len": "12"}, {"name": "IND_INSPTYPE_MAT_ACTIVE", "desc": "Combina\u00e7\u00e3o tipo de controle - material est\u00e1 ativa", "type": "CHAR", "len": "1"}, {"name": "PREFERRED_INSPTYPE", "desc": "Tipo de controle preferido", "type": "CHAR", "len": "1"}, {"name": "INSPTYPE_DELETE", "desc": "Tps.contr.a serem eliminados (distr.ALE QM)", "type": "CHAR", "len": "8"}, {"name": "CREATION_TIME", "desc": "Momento de gera\u00e7\u00e3o de um indicador de modifica\u00e7\u00e3o", "type": "CHAR", "len": "14"}, {"name": "MATERIAL_EXTERNAL", "desc": "N\u00ba de material longo para o campo MATERIAL", "type": "CHAR", "len": "40"}, {"name": "MATERIAL_GUID", "desc": "GUID externo para campo MATERIAL", "type": "CHAR", "len": "32"}, {"name": "MATERIAL_VERSION", "desc": "N\u00ba de vers\u00e3o para campo MATERIAL", "type": "CHAR", "len": "10"}, {"name": "IND_HU_INSPECTION", "desc": "Controle da unidade comercial", "type": "CHAR", "len": "1"}, {"name": "MS_FLAG", "desc": "C\u00f3digo: especifica\u00e7\u00f5es m\u00faltiplas", "type": "CHAR", "len": "1"}, {"name": "MATERIAL_LONG", "desc": "N\u00ba material (40 caracteres, necess\u00e1rio por raz\u00f5es t\u00e9cnicas)", "type": "CHAR", "len": "40"}], "max": 999999999}};</script>
</head>
<body>
    <header>
        <div class="brand">MATQM - Dados de Qualidade</div>
        <div class="search-box"><input type="text" id="searchInput" placeholder="Buscar..."></div>
        <div style="display:flex; gap:10px;">
             <button class="btn-csv" style="background:#15803d; color:white; border:none;" onclick="exportFullCSV()">CSV Completo</button>
             <button class="btn-payload" style="background:#2563eb; color:white; border:none;" onclick="openFullPayloadModal()">Payload Completo</button>
             <a href="index.html" style="text-decoration:none; color:#64748b; font-weight:600; font-size:0.9rem; align-self:center;">Voltar</a>
        </div>
    </header>
    <div class="workspace">
        <aside>
            <div class="history-container">
                <div class="history-header"><span class="history-title">Vistos Recentemente</span><button class="btn-clear-history" onclick="clearHistory()">Limpar</button></div>
                <div id="history-list" class="history-list"></div>
            </div>
            <div class="tree-container"><div class="tree-label">Navega√ß√£o</div><a href="#E1BP1001004_QMAT" class="node-item" style="padding-left: 10px" onclick="activateNode(this)"><strong>E1BP1001004_QMAT</strong></a></div></aside><main id="mainContent">
    <div id="E1BP1001004_QMAT" class="segment-card">
        <div class="card-header">
            <div class="card-title"><h2>E1BP1001004_QMAT <span class="desc">Dds.controle QM material (QMAT) ALE distribui√ß√£o com BAPI</span></h2></div>
            <div class="badges">
                <button class="btn-csv" onclick="exportToCSV('E1BP1001004_QMAT')">CSV</button>
                <button class="btn-payload" onclick="openPayloadModal('E1BP1001004_QMAT')">Payload</button>
                <span class="badge badge-req">Dados</span>
                <span class="badge badge-meta">M√°x: 999999999</span>
                <span class="badge badge-meta">36 campos</span>
            </div>
        </div>
        <div class="table-wrapper"><table><thead><tr><th style="width: 25%">Campo</th><th style="width: 55%">Descri√ß√£o</th><th style="width: 20%">Tipo/Tam</th></tr></thead><tbody><tr><td><span class="tech-name" onclick="copy(this)">FUNCTION</span></td><td>Fun√ß√£o</td><td><span class="dt-type">CHAR(3)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">INSPTYPE</span></td><td>Tipo de controle</td><td><span class="dt-type">CHAR(8)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MATERIAL</span></td><td>N¬∫ do material</td><td><span class="dt-type">CHAR(18)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">PLANT</span></td><td>Centro</td><td><span class="dt-type">CHAR(4)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_INSP_WITH_TSK_LIST</span></td><td>Controle com lista de tarefas</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_SPEC_MATSPEC</span></td><td>Controle com especifica√ß√£o de material</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_SPEC_CONFIG</span></td><td>Especifica√ß√µes de controle da configura√ß√£o</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_SPEC_BATCH</span></td><td>Especifica√ß√µes de controle da determina√ß√£o de lotes</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_AUTO_ASSIGN</span></td><td>Atribui√ß√£o autom√°tica de especifica√ß√µes</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_INSP_BY_CHARAC</span></td><td>Efetuar controle por caracter√≠sticas</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_POST_TO_INSP_STOCK</span></td><td>Registro em estoque em controle de qualidade</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_AUTOMATIC_UD</span></td><td>Decis√£o de utiliza√ß√£o autom√°tica prevista</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">SAMPLING_PROCEDURE</span></td><td>Processo de amostra</td><td><span class="dt-type">CHAR(8)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">DYN_MODIF_RULE</span></td><td>Regra de controle din√¢mico</td><td><span class="dt-type">CHAR(3)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">INSP_PERCENTAGE</span></td><td>Porcentagem de controle</td><td><span class="dt-type">DEC(3)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_100_PERCENT_INSPECTION</span></td><td>Controle a 100%</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_SKIPS_ALLOWED</span></td><td>Skips permitidos</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_MANUAL_SAMPLE</span></td><td>Indicar amostra manualmente</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_MANUAL_SAMPLE_CALC</span></td><td>Acionar c√°lculo de amostra manualmente</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_SINGLE_UNITS_POSSIBLE</span></td><td>Administra√ß√£o de n¬∫s de s√©rie</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">AVE_INSP_DURATION</span></td><td>Dura√ß√£o m√©dia do controle</td><td><span class="dt-type">DEC(3)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">CONTR_INSP_LOT_CREATE</span></td><td>Controle da cria√ß√£o de lote de controle (agrupamento lotes)</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">QUAL_SCORE_PROCEDURE</span></td><td>Processo para c√°lculo do √≠ndice de qualidade</td><td><span class="dt-type">CHAR(2)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">ALLOWED_SCRAP_SHARE</span></td><td>Quota de refugo permitida (em %) no lote de controle</td><td><span class="dt-type">DEC(6)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_SPECIAL_QM_ORDER</span></td><td>Entrar custos de controle na ordem QM individual</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">QM_ORDERID</span></td><td>N¬∫ ordem para a entrada de custos de controle</td><td><span class="dt-type">CHAR(12)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_INSPTYPE_MAT_ACTIVE</span></td><td>Combina√ß√£o tipo de controle - material est√° ativa</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">PREFERRED_INSPTYPE</span></td><td>Tipo de controle preferido</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">INSPTYPE_DELETE</span></td><td>Tps.contr.a serem eliminados (distr.ALE QM)</td><td><span class="dt-type">CHAR(8)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">CREATION_TIME</span></td><td>Momento de gera√ß√£o de um indicador de modifica√ß√£o</td><td><span class="dt-type">CHAR(14)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MATERIAL_EXTERNAL</span></td><td>N¬∫ de material longo para o campo MATERIAL</td><td><span class="dt-type">CHAR(40)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MATERIAL_GUID</span></td><td>GUID externo para campo MATERIAL</td><td><span class="dt-type">CHAR(32)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MATERIAL_VERSION</span></td><td>N¬∫ de vers√£o para campo MATERIAL</td><td><span class="dt-type">CHAR(10)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IND_HU_INSPECTION</span></td><td>Controle da unidade comercial</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MS_FLAG</span></td><td>C√≥digo: especifica√ß√µes m√∫ltiplas</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MATERIAL_LONG</span></td><td>N¬∫ material (40 caracteres, necess√°rio por raz√µes t√©cnicas)</td><td><span class="dt-type">CHAR(40)</span></td></tr></tbody></table></div>
    </div></main></div>
    <div id="payloadModal" class="modal-overlay"><div class="modal-container">
            <div class="modal-header"><div class="modal-title">Payload: <span id="modalSegName"></span></div><button class="modal-close" onclick="closePayloadModal()">&times;</button></div>
            <div class="payload-tabs"><div class="payload-tab active" onclick="switchTab('json')">JSON</div><div class="payload-tab" onclick="switchTab('xml')">XML</div></div>
            <div class="modal-body"><pre id="jsonContent" class="payload-content active"></pre><pre id="xmlContent" class="payload-content"></pre></div>
            <div class="modal-footer"><button class="btn-payload" onclick="copyCurrentPayload()">Copiar C√≥digo</button></div>
    </div></div>
    <div id="toast">Copiado!</div>
    <script>
        function copy(el) { navigator.clipboard.writeText(el.innerText).then(() => showToast()); }
        function showToast() { let t = document.getElementById('toast'); t.classList.add('show'); setTimeout(() => t.classList.remove('show'), 2000); }
        function activateNode(el) { document.querySelectorAll('.node-item').forEach(i => i.classList.remove('active')); el.classList.add('active'); }
        document.getElementById('searchInput').addEventListener('keyup', function(e) {
            let term = e.target.value.toUpperCase();
            document.querySelectorAll('.segment-card').forEach(card => {
                let show = false;
                if(card.querySelector('.card-header').innerText.toUpperCase().includes(term)) show = true;
                card.querySelectorAll('tbody tr').forEach(row => {
                    if(row.innerText.toUpperCase().includes(term)) { row.classList.remove('hidden'); show = true; } else { row.classList.add('hidden'); }
                });
                card.style.display = show ? 'block' : 'none';
            });
        });

        function exportFullCSV() {
            let csv = "Segmento;Campo;Descri√ß√£o;Tipo;Tamanho\n";
            for (const [segName, data] of Object.entries(SEGMENT_DEFINITIONS)) {
                data.fields.forEach(f => {
                    csv += `${segName};${f.name};${f.desc};${f.type};${f.len}\n`;
                });
            }
            downloadCSV(csv, "IDoc_Completo.csv");
        }

        function exportToCSV(segName) {
            const data = SEGMENT_DEFINITIONS[segName]; if(!data) return;
            let csv = "Campo;Descri√ß√£o;Tipo;Tamanho\n";
            data.fields.forEach(f => { csv += `${f.name};${f.desc};${f.type};${f.len}\n`; });
            downloadCSV(csv, `${segName}.csv`);
        }

        function downloadCSV(content, fileName) {
            const blob = new Blob(["\uFEFF" + content], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement("a");
            const url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", fileName);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function generateFakeValue(type, name) {
            if (!type) return "texto";
            if (type.includes('NUMC') || type.includes('INT') || type.includes('DEC')) return 123;
            if (type.includes('DATS')) return "20251231";
            if (type.includes('TIMS')) return "235959";
            if (name.includes('CURRENCY') || name.includes('WAERS')) return "BRL";
            if (name.includes('LANG')) return "PT";
            return "texto";
        }
        function getSegmentData(segName) {
            const def = SEGMENT_DEFINITIONS[segName]; if (!def) return {};
            const obj = {};
            def.fields.forEach(f => { obj[f.name] = generateFakeValue(f.type, f.name); });
            return obj;
        }
        function buildFullJson(nodes) {
            const result = {};
            const nodeList = Array.isArray(nodes) ? nodes : [nodes];
            nodeList.forEach(node => {
                let content = getSegmentData(node.segment);
                if (node.children && node.children.length > 0) Object.assign(content, buildFullJson(node.children));
                if (node.max > 1) result[node.segment] = [content]; else result[node.segment] = content;
            });
            return result;
        }
        function jsonToXml(obj, depth = 0) {
            let xml = ''; const indent = '  '.repeat(depth);
            for (const key in obj) {
                const value = obj[key];
                if (Array.isArray(value)) { value.forEach(item => { xml += `${indent}<${key}>\n` + jsonToXml(item, depth + 1) + `${indent}</${key}>\n`; }); }
                else if (typeof value === 'object' && value !== null) { xml += `${indent}<${key}>\n` + jsonToXml(value, depth + 1) + `${indent}</${key}>\n`; }
                else { xml += `${indent}<${key}>${value}</${key}>\n`; }
            }
            return xml;
        }
        function openPayloadModal(segName) {
            document.getElementById('modalSegName').innerText = segName;
            const data = getSegmentData(segName);
            document.getElementById('jsonContent').innerText = JSON.stringify(data, null, 2);
            document.getElementById('xmlContent').innerText = `<${segName}>\n${jsonToXml(data, 1)}</${segName}>`;
            document.getElementById('payloadModal').classList.add('open');
        }
        function openFullPayloadModal() {
            document.getElementById('modalSegName').innerText = "ESTRUTURA COMPLETA";
            let fullData = {};
            if (typeof IDOC_TREE !== 'undefined' && IDOC_TREE.length > 0) fullData = buildFullJson(IDOC_TREE);
            document.getElementById('jsonContent').innerText = JSON.stringify(fullData, null, 2);
            document.getElementById('xmlContent').innerText = `<IDOC>\n${jsonToXml(fullData, 1)}</IDOC>`;
            document.getElementById('payloadModal').classList.add('open');
        }
        function closePayloadModal() { document.getElementById('payloadModal').classList.remove('open'); }
        function switchTab(type) {
            document.querySelectorAll('.payload-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.payload-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(type + 'Content').classList.add('active');
        }
        function copyCurrentPayload() { navigator.clipboard.writeText(document.querySelector('.payload-content.active').innerText).then(() => showToast()); }
        (function() {
            const MAX_HISTORY = 10;
            const HISTORY_KEY = 'sap_docs_history';
            if (!window.location.pathname.endsWith('index.html')) {
                const standardizedTitle = document.title;
                const currentPage = { title: standardizedTitle, url: window.location.pathname.split('/').pop() };
                let history = JSON.parse(localStorage.getItem(HISTORY_KEY) || '[]');
                history = history.filter(h => h.url !== currentPage.url);
                history.unshift(currentPage);
                if (history.length > MAX_HISTORY) history.pop();
                localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
                const btn = document.createElement('a'); btn.id = 'global-back-btn'; btn.href = 'index.html'; btn.innerHTML = 'üè†'; btn.title = 'Voltar ao In√≠cio'; document.body.appendChild(btn);
            }
            const container = document.getElementById('history-list');
            if (container) {
                const history = JSON.parse(localStorage.getItem(HISTORY_KEY) || '[]');
                if (history.length === 0) container.innerHTML = '<div style="padding:5px 8px; font-size:0.75rem; color:#64748b;">Nenhum item recente.</div>';
                else { container.innerHTML = history.map(h => `<a href="${h.url}" class="history-link">${h.title}</a>`).join(''); }
            }
            window.clearHistory = function() { localStorage.removeItem(HISTORY_KEY); if(document.getElementById('history-list')) document.getElementById('history-list').innerHTML = ''; }
        })();
    </script>
</body>
</html>