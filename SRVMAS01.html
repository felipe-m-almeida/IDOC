<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRVMAS - Mestre de Servi칞os</title>
    <link rel="stylesheet" href="estilos.css">
    <script>const IDOC_TREE = [{"segment": "E1ASMDM", "max": 1, "children": [{"segment": "E1ASMDT", "max": 99, "children": [{"segment": "E1SMLTH", "max": 9, "children": [{"segment": "E1SMLTL", "max": 9999, "children": []}]}]}]}]; const SEGMENT_DEFINITIONS = {"E1ASMDM": {"desc": "Mestre servi\u00e7os prestados dados b\u00e1sicos", "fields": [{"name": "MSGFN", "desc": "Fun\u00e7\u00e3o (Create/Update/Delete)", "type": "CHAR", "len": "3"}, {"name": "ASNUM", "desc": "N\u00ba de servi\u00e7o", "type": "CHAR", "len": "18"}, {"name": "LVORM", "desc": "Marca\u00e7\u00e3o para elimina\u00e7\u00e3o", "type": "CHAR", "len": "1"}, {"name": "MATKL", "desc": "Grupo de mercadorias", "type": "CHAR", "len": "9"}, {"name": "MEINS", "desc": "Unidade de medida b\u00e1sica", "type": "UNIT", "len": "3"}, {"name": "ASTYP", "desc": "Categoria de servi\u00e7os", "type": "CHAR", "len": "4"}, {"name": "EAN11", "desc": "N\u00ba europeu do artigo (EAN)", "type": "CHAR", "len": "18"}, {"name": "NUMTP", "desc": "Ctg.de n\u00famero do EAN", "type": "CHAR", "len": "2"}, {"name": "SPART", "desc": "Setor de atividade", "type": "CHAR", "len": "2"}, {"name": "BEGRU", "desc": "Grupo de autoriza\u00e7\u00f5es", "type": "CHAR", "len": "4"}, {"name": "MSTAE", "desc": "Status material p/todos os centros", "type": "CHAR", "len": "2"}, {"name": "MSTDE", "desc": "Data validade status material", "type": "DATS", "len": "8"}, {"name": "BKLAS", "desc": "Classe de avalia\u00e7\u00e3o", "type": "CHAR", "len": "4"}, {"name": "LSTHI", "desc": "N\u00ba de servi\u00e7o de hierarquia", "type": "CHAR", "len": "18"}, {"name": "MLANG", "desc": "Idioma principal textos", "type": "LANG", "len": "1"}, {"name": "LGART", "desc": "Rubrica salarial", "type": "CHAR", "len": "4"}, {"name": "LBNUM", "desc": "Denomina\u00e7\u00e3o do tipo de servi\u00e7o", "type": "CHAR", "len": "3"}, {"name": "AUSGB", "desc": "Sa\u00edda do tipo de servi\u00e7o", "type": "NUMC", "len": "4"}, {"name": "STLVPOS", "desc": "Item de rela\u00e7\u00e3o de servi\u00e7os standard", "type": "CHAR", "len": "18"}, {"name": "TAXIM", "desc": "Indicador de imposto (compras)", "type": "CHAR", "len": "1"}, {"name": "IWUMZ", "desc": "Campo char (6)", "type": "CHAR", "len": "6"}, {"name": "IWUMN", "desc": "Campo char (6)", "type": "CHAR", "len": "6"}, {"name": "IWEIN", "desc": "Unidade de medida", "type": "CHAR", "len": "3"}, {"name": "FORMELNR", "desc": "N\u00ba f\u00f3rmula", "type": "CHAR", "len": "10"}, {"name": "CHGTEXT", "desc": "Mod.texto breve permit.", "type": "CHAR", "len": "1"}], "max": 1}, "E1ASMDT": {"desc": "Mestre de servi\u00e7os prestados textos breves", "fields": [{"name": "MSGFN", "desc": "Fun\u00e7\u00e3o", "type": "CHAR", "len": "3"}, {"name": "SPRAS", "desc": "C\u00f3digo de idioma", "type": "LANG", "len": "1"}, {"name": "ASKTX", "desc": "Texto breve servi\u00e7o", "type": "CHAR", "len": "40"}, {"name": "SPRAS_ISO", "desc": "C\u00f3digo idioma ISO", "type": "CHAR", "len": "2"}], "max": 99}, "E1SMLTH": {"desc": "Mestre de servi\u00e7os texto descritivo ID (Header)", "fields": [{"name": "MSGFN", "desc": "Fun\u00e7\u00e3o", "type": "CHAR", "len": "3"}, {"name": "TDOBJECT", "desc": "Textos: objeto de aplica\u00e7\u00e3o", "type": "CHAR", "len": "10"}, {"name": "TDNAME", "desc": "TDIC nome do texto", "type": "CHAR", "len": "16"}, {"name": "TDID", "desc": "ID de texto", "type": "CHAR", "len": "4"}, {"name": "TDSPRAS", "desc": "C\u00f3digo de idioma", "type": "LANG", "len": "1"}, {"name": "TDTEXTTYPE", "desc": "SAPscript: formato de um texto", "type": "CHAR", "len": "6"}, {"name": "TDSPRAS_ISO", "desc": "C\u00f3digo idioma ISO", "type": "CHAR", "len": "2"}], "max": 9}, "E1SMLTL": {"desc": "Mestre servi\u00e7os texto descritivo linha de texto", "fields": [{"name": "TDFORMAT", "desc": "Coluna de formato", "type": "CHAR", "len": "2"}, {"name": "TDLINE", "desc": "Linha de texto", "type": "CHAR", "len": "132"}], "max": 9999}};</script>
</head>
<body>
    <header>
        <div class="brand">SRVMAS - Mestre de Servi칞os</div>
        <div class="search-box"><input type="text" id="searchInput" placeholder="Buscar..."></div>
        <div style="display:flex; gap:10px;">
             <button class="btn-csv" style="background:#15803d; color:white; border:none;" onclick="exportFullCSV()">CSV Completo</button>
             <button class="btn-payload" style="background:#2563eb; color:white; border:none;" onclick="openFullPayloadModal()">Payload Completo</button>
             <a href="index.html" style="text-decoration:none; color:#64748b; font-weight:600; font-size:0.9rem; align-self:center;">Voltar</a>
        </div>
    </header>
    <div class="workspace">
        <aside>
            <div class="history-container">
                <div class="history-header"><span class="history-title">Vistos Recentemente</span><button class="btn-clear-history" onclick="clearHistory()">Limpar</button></div>
                <div id="history-list" class="history-list"></div>
            </div>
            <div class="tree-container"><div class="tree-label">Navega칞칚o</div><a href="#E1ASMDM" class="node-item" style="padding-left: 10px" onclick="activateNode(this)"><strong>E1ASMDM</strong></a><a href="#E1ASMDT" class="node-item" style="padding-left: 20px" onclick="activateNode(this)"><strong>E1ASMDT</strong></a><a href="#E1SMLTH" class="node-item" style="padding-left: 30px" onclick="activateNode(this)"><strong>E1SMLTH</strong></a><a href="#E1SMLTL" class="node-item" style="padding-left: 40px" onclick="activateNode(this)"><strong>E1SMLTL</strong></a></div></aside><main id="mainContent">
    <div id="E1ASMDM" class="segment-card">
        <div class="card-header">
            <div class="card-title"><h2>E1ASMDM <span class="desc">Mestre servi칞os prestados dados b치sicos</span></h2></div>
            <div class="badges">
                <button class="btn-csv" onclick="exportToCSV('E1ASMDM')">CSV</button>
                <button class="btn-payload" onclick="openPayloadModal('E1ASMDM')">Payload</button>
                <span class="badge badge-req">Dados</span>
                <span class="badge badge-meta">M치x: 1</span>
                <span class="badge badge-meta">25 campos</span>
            </div>
        </div>
        <div class="table-wrapper"><table><thead><tr><th style="width: 25%">Campo</th><th style="width: 55%">Descri칞칚o</th><th style="width: 20%">Tipo/Tam</th></tr></thead><tbody><tr><td><span class="tech-name" onclick="copy(this)">MSGFN</span></td><td>Fun칞칚o (Create/Update/Delete)</td><td><span class="dt-type">CHAR(3)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">ASNUM</span></td><td>N췈 de servi칞o</td><td><span class="dt-type">CHAR(18)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">LVORM</span></td><td>Marca칞칚o para elimina칞칚o</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MATKL</span></td><td>Grupo de mercadorias</td><td><span class="dt-type">CHAR(9)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MEINS</span></td><td>Unidade de medida b치sica</td><td><span class="dt-type">UNIT(3)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">ASTYP</span></td><td>Categoria de servi칞os</td><td><span class="dt-type">CHAR(4)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">EAN11</span></td><td>N췈 europeu do artigo (EAN)</td><td><span class="dt-type">CHAR(18)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">NUMTP</span></td><td>Ctg.de n칰mero do EAN</td><td><span class="dt-type">CHAR(2)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">SPART</span></td><td>Setor de atividade</td><td><span class="dt-type">CHAR(2)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">BEGRU</span></td><td>Grupo de autoriza칞칫es</td><td><span class="dt-type">CHAR(4)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MSTAE</span></td><td>Status material p/todos os centros</td><td><span class="dt-type">CHAR(2)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MSTDE</span></td><td>Data validade status material</td><td><span class="dt-type">DATS(8)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">BKLAS</span></td><td>Classe de avalia칞칚o</td><td><span class="dt-type">CHAR(4)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">LSTHI</span></td><td>N췈 de servi칞o de hierarquia</td><td><span class="dt-type">CHAR(18)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">MLANG</span></td><td>Idioma principal textos</td><td><span class="dt-type">LANG(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">LGART</span></td><td>Rubrica salarial</td><td><span class="dt-type">CHAR(4)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">LBNUM</span></td><td>Denomina칞칚o do tipo de servi칞o</td><td><span class="dt-type">CHAR(3)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">AUSGB</span></td><td>Sa칤da do tipo de servi칞o</td><td><span class="dt-type">NUMC(4)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">STLVPOS</span></td><td>Item de rela칞칚o de servi칞os standard</td><td><span class="dt-type">CHAR(18)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">TAXIM</span></td><td>Indicador de imposto (compras)</td><td><span class="dt-type">CHAR(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IWUMZ</span></td><td>Campo char (6)</td><td><span class="dt-type">CHAR(6)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IWUMN</span></td><td>Campo char (6)</td><td><span class="dt-type">CHAR(6)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">IWEIN</span></td><td>Unidade de medida</td><td><span class="dt-type">CHAR(3)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">FORMELNR</span></td><td>N췈 f칩rmula</td><td><span class="dt-type">CHAR(10)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">CHGTEXT</span></td><td>Mod.texto breve permit.</td><td><span class="dt-type">CHAR(1)</span></td></tr></tbody></table></div>
    </div>
    <div id="E1ASMDT" class="segment-card">
        <div class="card-header">
            <div class="card-title"><h2>E1ASMDT <span class="desc">Mestre de servi칞os prestados textos breves</span></h2></div>
            <div class="badges">
                <button class="btn-csv" onclick="exportToCSV('E1ASMDT')">CSV</button>
                <button class="btn-payload" onclick="openPayloadModal('E1ASMDT')">Payload</button>
                <span class="badge badge-req">Dados</span>
                <span class="badge badge-meta">M치x: 99</span>
                <span class="badge badge-meta">4 campos</span>
            </div>
        </div>
        <div class="table-wrapper"><table><thead><tr><th style="width: 25%">Campo</th><th style="width: 55%">Descri칞칚o</th><th style="width: 20%">Tipo/Tam</th></tr></thead><tbody><tr><td><span class="tech-name" onclick="copy(this)">MSGFN</span></td><td>Fun칞칚o</td><td><span class="dt-type">CHAR(3)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">SPRAS</span></td><td>C칩digo de idioma</td><td><span class="dt-type">LANG(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">ASKTX</span></td><td>Texto breve servi칞o</td><td><span class="dt-type">CHAR(40)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">SPRAS_ISO</span></td><td>C칩digo idioma ISO</td><td><span class="dt-type">CHAR(2)</span></td></tr></tbody></table></div>
    </div>
    <div id="E1SMLTH" class="segment-card">
        <div class="card-header">
            <div class="card-title"><h2>E1SMLTH <span class="desc">Mestre de servi칞os texto descritivo ID (Header)</span></h2></div>
            <div class="badges">
                <button class="btn-csv" onclick="exportToCSV('E1SMLTH')">CSV</button>
                <button class="btn-payload" onclick="openPayloadModal('E1SMLTH')">Payload</button>
                <span class="badge badge-req">Dados</span>
                <span class="badge badge-meta">M치x: 9</span>
                <span class="badge badge-meta">7 campos</span>
            </div>
        </div>
        <div class="table-wrapper"><table><thead><tr><th style="width: 25%">Campo</th><th style="width: 55%">Descri칞칚o</th><th style="width: 20%">Tipo/Tam</th></tr></thead><tbody><tr><td><span class="tech-name" onclick="copy(this)">MSGFN</span></td><td>Fun칞칚o</td><td><span class="dt-type">CHAR(3)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">TDOBJECT</span></td><td>Textos: objeto de aplica칞칚o</td><td><span class="dt-type">CHAR(10)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">TDNAME</span></td><td>TDIC nome do texto</td><td><span class="dt-type">CHAR(16)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">TDID</span></td><td>ID de texto</td><td><span class="dt-type">CHAR(4)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">TDSPRAS</span></td><td>C칩digo de idioma</td><td><span class="dt-type">LANG(1)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">TDTEXTTYPE</span></td><td>SAPscript: formato de um texto</td><td><span class="dt-type">CHAR(6)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">TDSPRAS_ISO</span></td><td>C칩digo idioma ISO</td><td><span class="dt-type">CHAR(2)</span></td></tr></tbody></table></div>
    </div>
    <div id="E1SMLTL" class="segment-card">
        <div class="card-header">
            <div class="card-title"><h2>E1SMLTL <span class="desc">Mestre servi칞os texto descritivo linha de texto</span></h2></div>
            <div class="badges">
                <button class="btn-csv" onclick="exportToCSV('E1SMLTL')">CSV</button>
                <button class="btn-payload" onclick="openPayloadModal('E1SMLTL')">Payload</button>
                <span class="badge badge-req">Dados</span>
                <span class="badge badge-meta">M치x: 9999</span>
                <span class="badge badge-meta">2 campos</span>
            </div>
        </div>
        <div class="table-wrapper"><table><thead><tr><th style="width: 25%">Campo</th><th style="width: 55%">Descri칞칚o</th><th style="width: 20%">Tipo/Tam</th></tr></thead><tbody><tr><td><span class="tech-name" onclick="copy(this)">TDFORMAT</span></td><td>Coluna de formato</td><td><span class="dt-type">CHAR(2)</span></td></tr><tr><td><span class="tech-name" onclick="copy(this)">TDLINE</span></td><td>Linha de texto</td><td><span class="dt-type">CHAR(132)</span></td></tr></tbody></table></div>
    </div></main></div>
    <div id="payloadModal" class="modal-overlay"><div class="modal-container">
            <div class="modal-header"><div class="modal-title">Payload: <span id="modalSegName"></span></div><button class="modal-close" onclick="closePayloadModal()">&times;</button></div>
            <div class="payload-tabs"><div class="payload-tab active" onclick="switchTab('json')">JSON</div><div class="payload-tab" onclick="switchTab('xml')">XML</div></div>
            <div class="modal-body"><pre id="jsonContent" class="payload-content active"></pre><pre id="xmlContent" class="payload-content"></pre></div>
            <div class="modal-footer"><button class="btn-payload" onclick="copyCurrentPayload()">Copiar C칩digo</button></div>
    </div></div>
    <div id="toast">Copiado!</div>
    <script>
        function copy(el) { navigator.clipboard.writeText(el.innerText).then(() => showToast()); }
        function showToast() { let t = document.getElementById('toast'); t.classList.add('show'); setTimeout(() => t.classList.remove('show'), 2000); }
        function activateNode(el) { document.querySelectorAll('.node-item').forEach(i => i.classList.remove('active')); el.classList.add('active'); }
        document.getElementById('searchInput').addEventListener('keyup', function(e) {
            let term = e.target.value.toUpperCase();
            document.querySelectorAll('.segment-card').forEach(card => {
                let show = false;
                if(card.querySelector('.card-header').innerText.toUpperCase().includes(term)) show = true;
                card.querySelectorAll('tbody tr').forEach(row => {
                    if(row.innerText.toUpperCase().includes(term)) { row.classList.remove('hidden'); show = true; } else { row.classList.add('hidden'); }
                });
                card.style.display = show ? 'block' : 'none';
            });
        });

        function exportFullCSV() {
            let csv = "Segmento;Campo;Descri칞칚o;Tipo;Tamanho\n";
            for (const [segName, data] of Object.entries(SEGMENT_DEFINITIONS)) {
                data.fields.forEach(f => {
                    csv += `${segName};${f.name};${f.desc};${f.type};${f.len}\n`;
                });
            }
            downloadCSV(csv, "IDoc_Completo.csv");
        }

        function exportToCSV(segName) {
            const data = SEGMENT_DEFINITIONS[segName]; if(!data) return;
            let csv = "Campo;Descri칞칚o;Tipo;Tamanho\n";
            data.fields.forEach(f => { csv += `${f.name};${f.desc};${f.type};${f.len}\n`; });
            downloadCSV(csv, `${segName}.csv`);
        }

        function downloadCSV(content, fileName) {
            const blob = new Blob(["\uFEFF" + content], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement("a");
            const url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", fileName);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function generateFakeValue(type, name) {
            if (!type) return "texto";
            if (type.includes('NUMC') || type.includes('INT') || type.includes('DEC')) return 123;
            if (type.includes('DATS')) return "20251231";
            if (type.includes('TIMS')) return "235959";
            if (name.includes('CURRENCY') || name.includes('WAERS')) return "BRL";
            if (name.includes('LANG')) return "PT";
            return "texto";
        }
        function getSegmentData(segName) {
            const def = SEGMENT_DEFINITIONS[segName]; if (!def) return {};
            const obj = {};
            def.fields.forEach(f => { obj[f.name] = generateFakeValue(f.type, f.name); });
            return obj;
        }
        function buildFullJson(nodes) {
            const result = {};
            const nodeList = Array.isArray(nodes) ? nodes : [nodes];
            nodeList.forEach(node => {
                let content = getSegmentData(node.segment);
                if (node.children && node.children.length > 0) Object.assign(content, buildFullJson(node.children));
                if (node.max > 1) result[node.segment] = [content]; else result[node.segment] = content;
            });
            return result;
        }
        function jsonToXml(obj, depth = 0) {
            let xml = ''; const indent = '  '.repeat(depth);
            for (const key in obj) {
                const value = obj[key];
                if (Array.isArray(value)) { value.forEach(item => { xml += `${indent}<${key}>\n` + jsonToXml(item, depth + 1) + `${indent}</${key}>\n`; }); }
                else if (typeof value === 'object' && value !== null) { xml += `${indent}<${key}>\n` + jsonToXml(value, depth + 1) + `${indent}</${key}>\n`; }
                else { xml += `${indent}<${key}>${value}</${key}>\n`; }
            }
            return xml;
        }
        function openPayloadModal(segName) {
            document.getElementById('modalSegName').innerText = segName;
            const data = getSegmentData(segName);
            document.getElementById('jsonContent').innerText = JSON.stringify(data, null, 2);
            document.getElementById('xmlContent').innerText = `<${segName}>\n${jsonToXml(data, 1)}</${segName}>`;
            document.getElementById('payloadModal').classList.add('open');
        }
        function openFullPayloadModal() {
            document.getElementById('modalSegName').innerText = "ESTRUTURA COMPLETA";
            let fullData = {};
            if (typeof IDOC_TREE !== 'undefined' && IDOC_TREE.length > 0) fullData = buildFullJson(IDOC_TREE);
            document.getElementById('jsonContent').innerText = JSON.stringify(fullData, null, 2);
            document.getElementById('xmlContent').innerText = `<IDOC>\n${jsonToXml(fullData, 1)}</IDOC>`;
            document.getElementById('payloadModal').classList.add('open');
        }
        function closePayloadModal() { document.getElementById('payloadModal').classList.remove('open'); }
        function switchTab(type) {
            document.querySelectorAll('.payload-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.payload-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(type + 'Content').classList.add('active');
        }
        function copyCurrentPayload() { navigator.clipboard.writeText(document.querySelector('.payload-content.active').innerText).then(() => showToast()); }
        (function() {
            const MAX_HISTORY = 10;
            const HISTORY_KEY = 'sap_docs_history';
            if (!window.location.pathname.endsWith('index.html')) {
                const standardizedTitle = document.title;
                const currentPage = { title: standardizedTitle, url: window.location.pathname.split('/').pop() };
                let history = JSON.parse(localStorage.getItem(HISTORY_KEY) || '[]');
                history = history.filter(h => h.url !== currentPage.url);
                history.unshift(currentPage);
                if (history.length > MAX_HISTORY) history.pop();
                localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
                const btn = document.createElement('a'); btn.id = 'global-back-btn'; btn.href = 'index.html'; btn.innerHTML = '游'; btn.title = 'Voltar ao In칤cio'; document.body.appendChild(btn);
            }
            const container = document.getElementById('history-list');
            if (container) {
                const history = JSON.parse(localStorage.getItem(HISTORY_KEY) || '[]');
                if (history.length === 0) container.innerHTML = '<div style="padding:5px 8px; font-size:0.75rem; color:#64748b;">Nenhum item recente.</div>';
                else { container.innerHTML = history.map(h => `<a href="${h.url}" class="history-link">${h.title}</a>`).join(''); }
            }
            window.clearHistory = function() { localStorage.removeItem(HISTORY_KEY); if(document.getElementById('history-list')) document.getElementById('history-list').innerHTML = ''; }
        })();
    </script>
</body>
</html>